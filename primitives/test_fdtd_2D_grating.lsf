addrect;
set('name', 'waveguide');
set('x min', 0);
set('x max', 1.45e-05);
set('y', 0);
set('y span', 2e-07);
set('override mesh order from material database', 1);
set('index', 3.5);
set('mesh order', 10);
addrect;
set('name', 'tooth_1');
set('x min', 1.06e-06);
set('x max', 1.2e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_2');
set('x min', 1.76e-06);
set('x max', 1.9e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_3');
set('x min', 2.46e-06);
set('x max', 2.6e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_4');
set('x min', 3.16e-06);
set('x max', 3.3e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_5');
set('x min', 3.86e-06);
set('x max', 4e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_6');
set('x min', 4.56e-06);
set('x max', 4.7e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_7');
set('x min', 5.26e-06);
set('x max', 5.4e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_8');
set('x min', 5.96e-06);
set('x max', 6.1e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_9');
set('x min', 6.66e-06);
set('x max', 6.8e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_10');
set('x min', 7.36e-06);
set('x max', 7.5e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_11');
set('x min', 8.06e-06);
set('x max', 8.2e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_12');
set('x min', 8.76e-06);
set('x max', 8.9e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_13');
set('x min', 9.46e-06);
set('x max', 9.6e-06);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_14');
set('x min', 1.016e-05);
set('x max', 1.03e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_15');
set('x min', 1.086e-05);
set('x max', 1.1e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_16');
set('x min', 1.156e-05);
set('x max', 1.17e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_17');
set('x min', 1.226e-05);
set('x max', 1.24e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_18');
set('x min', 1.296e-05);
set('x max', 1.31e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_19');
set('x min', 1.366e-05);
set('x max', 1.38e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addrect;
set('name', 'tooth_20');
set('x min', 1.436e-05);
set('x max', 1.45e-05);
set('y max', 1e-07);
set('y min', 0);
set('index', 1);
set('override mesh order from material database', 1);
set('mesh order', 2);
addfdtd;
set('x min', 0);
set('x max', 1.55e-05);
set('y min', -2e-06);
set('y max', 2e-06);
set('dimension', '2D');
set('background index', 1);
set('mesh type', 'uniform');
set('define x mesh by', 'maximum mesh step');
set('define y mesh by', 'maximum mesh step');
set('dx', 1e-08);
set('dy', 1e-08);
addmode;
set('name', 'wg_mode_source');
set('injection axis', 'x-axis');
set('direction', 'Forward');
set('mode selection', 'fundamental mode');
set('x', 2.5e-07);
set('y', 0);
set('y span', 4e-06);
set('center wavelength', 1.55e-06);
set('wavelength span', 1e-07);
addindex;
set('name', 'index_monitor1');
set('x min', 0);
set('x max', 1.55e-05);
set('y min', -2e-06);
set('y max', 2e-06);
index_prev_var = getresult('index_monitor1', 'index preview');
index_profile = getattribute(index_prev_var, 'index_x');
x_coords = getparameter(index_prev_var, 'x');
y_coords = getparameter(index_prev_var, 'y');

addpower;
set('name', 'field_power_monitor1');
set('simulation type', '2D Z-normal');
set('monitor type', '2D Z-normal');
set('x min', 0);
set('x max', 1.55e-05);
set('y min', -2e-06);
set('y max', 2e-06);
set('override global monitor settings', 1);
set('use source limits', 1);
set('frequency points', 20);
set('output Px', 1);
set('output Py', 1);
addpower;
set('name', 'monitor_up');
set('simulation type', '2D Z-normal');
set('monitor type', 'Linear X');
set('x min', 0);
set('x max', 1.55e-05);
set('y', 1.98e-06);
set('override global monitor settings', 1);
set('use source limits', 1);
set('frequency points', 20);
save('test_fdtd_2D_grating');
run;

Ez = getresult('field_power_monitor1', 'Ez');
Px = getresult('field_power_monitor1', 'Px');
Py = getresult('field_power_monitor1', 'Py');
x = getresult('field_power_monitor1', 'x');
y = getresult('field_power_monitor1', 'y');
f = getresult('field_power_monitor1', 'f');

